CREATE TABLE `mtt_wx_auth` (`id` int(10) unsigned NOT NULL AUTO_INCREMENT,`instance_id` int(11) NOT NULL DEFAULT '0' COMMENT '店铺id',`authorizer_appid` varchar(255) NOT NULL DEFAULT '' COMMENT '店铺的appid  授权之后不用刷新',`authorizer_refresh_token` varchar(255) NOT NULL DEFAULT '' COMMENT '店铺授权之后的刷新token，每月刷新',`authorizer_access_token` varchar(255) NOT NULL DEFAULT '' COMMENT '店铺的公众号token，只有2小时',`func_info` varchar(1000) NOT NULL DEFAULT '' COMMENT '授权项目',`nick_name` varchar(50) NOT NULL DEFAULT '' COMMENT '公众号昵称',`head_img` varchar(255) NOT NULL DEFAULT '' COMMENT '公众号头像url',`user_name` varchar(50) NOT NULL DEFAULT '' COMMENT '公众号原始账号',`alias` varchar(255) NOT NULL DEFAULT '' COMMENT '公众号原始名称',`qrcode_url` varchar(255) NOT NULL DEFAULT '' COMMENT '公众号二维码url',`auth_time` int(11) DEFAULT '0' COMMENT '授权时间',PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=8192 COMMENT='店铺(实例)微信公众账号授权';
CREATE TABLE `mtt_wx_config` (`id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键',`instance_id` int(11) NOT NULL DEFAULT '1' COMMENT '实例ID',`key` varchar(255) NOT NULL DEFAULT '' COMMENT '配置项WCHAT,QQ,WPAY,ALIPAY...',`value` varchar(1000) NOT NULL DEFAULT '' COMMENT '配置值json',`desc` varchar(1000) NOT NULL DEFAULT '' COMMENT '描述',`is_use` tinyint(4) NOT NULL DEFAULT '0' COMMENT '是否启用 1启用 0不启用',`create_time` int(11) DEFAULT '0' COMMENT '创建时间',`modify_time` int(11) DEFAULT '0' COMMENT '修改时间',PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=963 COMMENT='第三方配置表';
CREATE TABLE `mtt_wx_default_replay` (`id` int(10) unsigned NOT NULL AUTO_INCREMENT,`instance_id` int(11) NOT NULL COMMENT '店铺id',`reply_media_id` int(11) NOT NULL COMMENT '回复媒体内容id',`sort` int(11) NOT NULL,`create_time` int(11) DEFAULT '0',`modify_time` int(11) DEFAULT '0',PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=16384 COMMENT='关注时回复';
CREATE TABLE `mtt_wx_fans` (`fans_id` int(11) NOT NULL AUTO_INCREMENT COMMENT '粉丝ID',`uid` int(11) NOT NULL DEFAULT '0' COMMENT '会员编号ID',`source_uid` int(11) NOT NULL DEFAULT '0' COMMENT '推广人uid',`instance_id` int(11) NOT NULL COMMENT '店铺ID',`nickname` varchar(255) NOT NULL COMMENT '昵称',`nickname_decode` varchar(255) DEFAULT '',`headimgurl` varchar(500) NOT NULL DEFAULT '' COMMENT '头像',`sex` smallint(6) NOT NULL DEFAULT '1' COMMENT '性别',`language` varchar(20) NOT NULL DEFAULT '' COMMENT '用户语言',`country` varchar(60) NOT NULL DEFAULT '' COMMENT '国家',`province` varchar(255) NOT NULL DEFAULT '' COMMENT '省',`city` varchar(255) NOT NULL DEFAULT '' COMMENT '城市',`district` varchar(255) NOT NULL DEFAULT '' COMMENT '行政区/县',`openid` varchar(255) NOT NULL DEFAULT '' COMMENT '用户的标识，对当前公众号唯一     用户的唯一身份ID',`unionid` varchar(255) NOT NULL DEFAULT '' COMMENT '粉丝unionid',`groupid` int(11) NOT NULL DEFAULT '0' COMMENT '粉丝所在组id',`is_subscribe` bigint(1) NOT NULL DEFAULT '1' COMMENT '是否订阅',`memo` varchar(255) NOT NULL COMMENT '备注',`subscribe_date` int(11) DEFAULT '0' COMMENT '订阅时间',`unsubscribe_date` int(11) DEFAULT '0' COMMENT '解订阅时间',`update_date` int(11) DEFAULT '0' COMMENT '粉丝信息最后更新时间',PRIMARY KEY (`fans_id`),KEY `IDX_sys_weixin_fans_openid` (`openid`),KEY `IDX_sys_weixin_fans_unionid` (`unionid`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=1638 COMMENT='微信公众号获取粉丝列表';
CREATE TABLE `mtt_wx_follow_replay` (`id` int(10) unsigned NOT NULL AUTO_INCREMENT,`instance_id` int(11) NOT NULL COMMENT '店铺id',`reply_media_id` int(11) NOT NULL COMMENT '回复媒体内容id',`sort` int(11) NOT NULL,`create_time` int(11) DEFAULT '0',`modify_time` int(11) DEFAULT '0',PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=16384 COMMENT='关注时回复';
CREATE TABLE `mtt_wx_key_replay` (`id` int(10) unsigned NOT NULL AUTO_INCREMENT,`instance_id` int(11) NOT NULL COMMENT '店铺id',`key` varchar(255) NOT NULL COMMENT '关键词',`match_type` tinyint(4) NOT NULL COMMENT '匹配类型1模糊匹配2全部匹配',`reply_media_id` int(11) NOT NULL COMMENT '回复媒体内容id',`sort` int(11) NOT NULL,`create_time` int(11) DEFAULT '0',`modify_time` int(11) DEFAULT '0',PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=16384 COMMENT='关键词回复';
CREATE TABLE `mtt_wx_media` (`media_id` int(11) unsigned NOT NULL AUTO_INCREMENT COMMENT '图文消息id',`title` varchar(100) DEFAULT NULL,`instance_id` int(11) NOT NULL DEFAULT '0' COMMENT '实例id店铺id',`type` varchar(255) NOT NULL DEFAULT '1' COMMENT '类型1文本(项表无内容) 2单图文 3多图文',`sort` int(11) NOT NULL DEFAULT '0',`create_time` int(11) DEFAULT '0' COMMENT '创建日期',`modify_time` int(11) DEFAULT '0' COMMENT '修改日期',PRIMARY KEY (`media_id`),UNIQUE KEY `id` (`media_id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=1170;
CREATE TABLE `mtt_wx_media_item` (`id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'id',`media_id` int(11) NOT NULL COMMENT '图文消息id',`title` varchar(100) DEFAULT NULL,`author` varchar(50) NOT NULL COMMENT '作者',`cover` varchar(200) NOT NULL COMMENT '图文消息封面',`show_cover_pic` tinyint(4) NOT NULL DEFAULT '1' COMMENT '封面图片显示在正文中',`summary` text,`content` text NOT NULL COMMENT '正文',`content_source_url` varchar(200) NOT NULL DEFAULT '' COMMENT '图文消息的原文地址，即点击“阅读原文”后的URL',`sort` int(11) NOT NULL DEFAULT '0' COMMENT '排序号',`hits` int(11) NOT NULL DEFAULT '0' COMMENT '阅读次数',PRIMARY KEY (`id`),KEY `id` (`media_id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=712;
CREATE TABLE `mtt_wx_menu` (`menu_id` int(11) NOT NULL AUTO_INCREMENT COMMENT '主键',`instance_id` int(11) NOT NULL DEFAULT '0' COMMENT '店铺id',`menu_name` varchar(50) NOT NULL DEFAULT '' COMMENT '菜单名称',`ico` varchar(32) NOT NULL DEFAULT '' COMMENT '菜图标单',`pid` int(11) NOT NULL DEFAULT '0' COMMENT '父菜单',`menu_event_type` tinyint(4) NOT NULL DEFAULT '1' COMMENT '1普通url 2 图文素材 3 功能',`media_id` int(11) NOT NULL DEFAULT '0' COMMENT '图文消息ID',`menu_event_url` varchar(255) NOT NULL DEFAULT '' COMMENT '菜单url',`hits` int(11) NOT NULL DEFAULT '0' COMMENT '触发数',`sort` int(11) NOT NULL DEFAULT '0' COMMENT '排序',`create_date` int(11) DEFAULT '0' COMMENT '创建日期',`modify_date` int(11) DEFAULT '0' COMMENT '修改日期',PRIMARY KEY (`menu_id`),KEY `IDX_biz_shop_menu_orders` (`sort`),KEY `IDX_biz_shop_menu_shopId` (`instance_id`)) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 AVG_ROW_LENGTH=1638 COMMENT='微设置->微店菜单';
CREATE TABLE `mtt_wx_user` (`id` int(11) NOT NULL AUTO_INCREMENT COMMENT '表id',`uid` int(11) NOT NULL COMMENT 'uid',`wxname` varchar(60) NOT NULL COMMENT '公众号名称',`aeskey` varchar(256) NOT NULL DEFAULT '' COMMENT 'aeskey',`encode` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'encode',`appid` varchar(50) NOT NULL DEFAULT '' COMMENT 'appid',`appsecret` varchar(50) NOT NULL DEFAULT '' COMMENT 'appsecret',`wxid` varchar(64) NOT NULL COMMENT '公众号原始ID',`weixin` char(64) NOT NULL COMMENT '微信号',`token` char(255) NOT NULL COMMENT 'token',`w_token` varchar(150) NOT NULL DEFAULT '' COMMENT '微信对接token',`create_time` int(11) NOT NULL COMMENT 'create_time',`updatetime` int(11) NOT NULL COMMENT 'updatetime',`tplcontentid` varchar(2) NOT NULL COMMENT '内容模版ID',`share_ticket` varchar(150) NOT NULL COMMENT '分享ticket',`share_dated` char(15) NOT NULL COMMENT 'share_dated',`authorizer_access_token` varchar(200) NOT NULL COMMENT 'authorizer_access_token',`authorizer_refresh_token` varchar(200) NOT NULL COMMENT 'authorizer_refresh_token',`authorizer_expires` char(10) NOT NULL COMMENT 'authorizer_expires',`type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '类型',`web_access_token` varchar(200) NOT NULL COMMENT '网页授权token',`web_refresh_token` varchar(200) NOT NULL COMMENT 'web_refresh_token',`web_expires` int(11) NOT NULL COMMENT '过期时间',`menu_config` text COMMENT '菜单',`wait_access` tinyint(1) DEFAULT '0' COMMENT '微信接入状态,0待接入1已接入',`concern` varchar(225) DEFAULT '' COMMENT '关注回复',`default` varchar(225) DEFAULT '' COMMENT '默认回复',PRIMARY KEY (`id`),KEY `uid` (`uid`),KEY `uid_2` (`uid`)) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='微信公共帐号';
CREATE TABLE `mtt_wx_user_msg` (`msg_id` int(10) unsigned NOT NULL AUTO_INCREMENT,`uid` int(11) NOT NULL,`msg_type` varchar(255) NOT NULL,`content` text,`is_replay` int(11) NOT NULL DEFAULT '0' COMMENT '是否回复',`create_time` int(11) DEFAULT '0',PRIMARY KEY (`msg_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='微信用户消息表';
CREATE TABLE `mtt_wx_user_msg_replay` (`replay_id` int(10) unsigned NOT NULL AUTO_INCREMENT,`msg_id` int(11) NOT NULL,`replay_uid` int(11) NOT NULL COMMENT '当前客服uid',`replay_type` varchar(255) NOT NULL,`content` text,`replay_time` int(11) DEFAULT '0',PRIMARY KEY (`replay_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='微信用户消息回复表';
INSERT INTO `mtt_auth_rule` VALUES ('206', 'Wechat', '微信管理', '1', '1', '0', 'icon-bubbles2', '', '0', '8', '1487063570', '0', '1');
INSERT INTO `mtt_auth_rule` VALUES ('207', 'Wechat/config', '公众号管理', '1', '1', '0', '', '', '206', '1', '1487063705', '0', '1');
INSERT INTO `mtt_auth_rule` VALUES ('208', 'Wechat/menu', '菜单管理', '1', '1', '0', '', '', '206', '2', '1487063765', '0', '1');
INSERT INTO `mtt_auth_rule` VALUES ('209', 'Wechat/materialmessage', '消息素材', '1', '1', '0', '', '', '206', '3', '1487063834', '0', '1');
INSERT INTO `mtt_auth_rule` VALUES ('212', 'Wechat/weixin', '操作-设置', '1', '1', '0', '', '', '207', '1', '1487064541', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('213', 'Wechat/addMenu', '操作-添加', '1', '1', '0', '', '', '208', '1', '1487149151', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('214', 'Wechat/editText', '操作-编辑', '1', '1', '0', '', '', '209', '2', '1487233984', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('215', 'Wechat/addText', '操作-添加', '1', '1', '0', '', '', '209', '1', '1487234062', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('258', 'Wechat/editMenu', '操作-编辑', '1', '1', '0', '', '', '208', '2', '1497429671', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('259', 'Wechat/menuOrder', '操作-排序', '1', '1', '0', '', '', '208', '3', '1497429707', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('260', 'Wechat/menuState', '操作-状态', '1', '1', '0', '', '', '208', '4', '1497429764', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('261', 'Wechat/delMenu', '操作-删除', '1', '1', '0', '', '', '208', '5', '1497429822', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('262', 'Wechat/createMenu', '操作-生成菜单', '1', '1', '0', '', '', '208', '6', '1497429886', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('263', 'Wechat/delText', '操作-删除', '1', '1', '0', '', '', '209', '3', '1497430020', '0', '0');
INSERT INTO `mtt_auth_rule` VALUES ('273', 'Wechat/replay', '回复设置', '1', '1', '0', '', '', '206', '4', '1508215988', '0', '1');